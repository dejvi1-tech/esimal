var e=Object.defineProperty,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,t=(a,r,s)=>r in a?e(a,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[r]=s,n=(e,a,r)=>new Promise((s,t)=>{var n=e=>{try{c(r.next(e))}catch(a){t(a)}},l=e=>{try{c(r.throw(e))}catch(a){t(a)}},c=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,l);c((r=r.apply(e,a)).next())});import{j as l}from"./ui-vendor-Cb7BQMVa.js";import{h as c,a as i}from"./react-vendor-gzvTUj6_.js";import{c as o,f as d,B as m,i as x}from"./index-DcjmXfUi.js";import{a as u}from"./utils-vendor-Dyq5Ev4R.js";import{I as p,S as h}from"./input-C88j5Rzx.js";import{G as g}from"./globe-CsKsfH-s.js";import{W as f}from"./wifi-BjfIGaaq.js";import"./animation-vendor-U7UFP-tZ.js";
/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=o("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),v=o("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),j=u("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function b(e){var n=e,{className:c,variant:i}=n,o=((e,t)=>{var n={};for(var l in e)r.call(e,l)&&t.indexOf(l)<0&&(n[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&s.call(e,l)&&(n[l]=e[l]);return n})(n,["className","variant"]);return l.jsx("div",((e,n)=>{for(var l in n||(n={}))r.call(n,l)&&t(e,l,n[l]);if(a)for(var l of a(n))s.call(n,l)&&t(e,l,n[l]);return e})({className:d(j({variant:i}),c)},o))}const N=()=>{const[e,a]=c(),[r,s]=i.useState(e.get("country")||""),[t,o]=i.useState([]),[d,u]=i.useState(!1),[j,N]=i.useState(""),[w,k]=i.useState(null),[S,O]=i.useState(""),[P,I]=i.useState("");i.useEffect(()=>{r&&F(r)},[r]);const F=e=>n(null,null,function*(){u(!0),N("");try{const a=yield fetch(`/api/search-packages?country=${encodeURIComponent(e)}`);if(a.ok){const e=yield a.json();o(e)}else N("Failed to search packages")}catch(a){N("Failed to search packages")}finally{u(!1)}});return l.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Search eSIM Packages"}),l.jsx("p",{className:"text-xl text-gray-600",children:"Find the perfect eSIM package for your destination"})]}),l.jsx("div",{className:"max-w-2xl mx-auto mb-12",children:l.jsxs("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&(a({country:r.trim()}),F(r.trim()))},className:"flex gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(p,{type:"text",placeholder:"Enter country name (e.g., Germany, France, Spain)",value:r,onChange:e=>s(e.target.value),className:"w-full"})}),l.jsxs(m,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[l.jsx(h,{className:"w-4 h-4 mr-2"}),"Search"]})]})}),d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("div",{className:"text-xl",children:"Searching packages..."})}),j&&l.jsx("div",{className:"text-center py-12",children:l.jsxs("div",{className:"text-red-600",children:["Error: ",j]})}),!d&&!j&&r&&l.jsxs("div",{children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Packages for ",r]}),l.jsxs("p",{className:"text-gray-600",children:[t.length," package",1!==t.length?"s":""," found"]})]}),0===t.length?l.jsx("div",{className:"text-center py-12",children:l.jsxs("div",{className:"text-gray-500 text-lg",children:['No packages found for "',r,'". Try a different country name.']})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>l.jsx("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden",children:l.jsxs("div",{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.name}),l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(g,{className:"w-4 h-4 text-blue-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:e.country_name})]}),l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(f,{className:"w-4 h-4 text-blue-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:x(e.data_amount)})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(y,{className:"w-4 h-4 text-green-500"}),l.jsxs("span",{className:"text-sm text-gray-600",children:[e.validity_days," days"]})]})]}),l.jsx("div",{className:"text-center mb-4",children:l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¬",e.sale_price.toFixed(2)]})}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-6 justify-center",children:[l.jsx(b,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:"4G/5G"}),l.jsx(b,{variant:"secondary",className:"bg-green-100 text-green-700 text-xs",children:"Instant"}),l.jsx(b,{variant:"secondary",className:"bg-purple-100 text-purple-700 text-xs",children:e.region})]}),l.jsxs("div",{className:"space-y-3 mb-4",children:[l.jsx("input",{type:"email",placeholder:"Your email address",value:S,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("input",{type:"text",placeholder:"Your name (optional)",value:P,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs(m,{onClick:()=>(e=>n(null,null,function*(){if(S.trim()){k(e.id);try{const a=yield fetch("/api/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:e.id,userEmail:S.trim(),userName:P.trim()||S.trim()})}),r=yield a.json();a.ok?(alert(`Order created successfully! QR code will be sent to ${S}`),O(""),I("")):alert(`Failed to create order: ${r.error||"Unknown error"}`)}catch(a){alert("Failed to create order. Please try again.")}finally{k(null)}}else alert("Please enter your email address")}))(e),disabled:w===e.id,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white py-2 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[l.jsx(v,{className:"w-4 h-4"}),w===e.id?"Processing...":"Buy Now"]})]})},e.id))})]}),!d&&!j&&!r&&l.jsx("div",{className:"text-center py-12",children:l.jsx("div",{className:"text-gray-500 text-lg",children:"Enter a country name above to search for eSIM packages."})})]})})};export{N as default};
