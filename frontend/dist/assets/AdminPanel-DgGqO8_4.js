var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,l=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&i(e,t,a[t]);if(s)for(var t of s(a))n.call(a,t)&&i(e,t,a[t]);return e},d=(e,s)=>a(e,t(s)),c=(e,a,t)=>new Promise((s,r)=>{var n=e=>{try{l(t.next(e))}catch(a){r(a)}},i=e=>{try{l(t.throw(e))}catch(a){r(a)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,i);l((t=t.apply(e,a)).next())});import{j as o}from"./ui-vendor-Cb7BQMVa.js";import{a as p}from"./react-vendor-gzvTUj6_.js";import{e as m}from"./countries-CNVzw6Kl.js";import{h as x}from"./index-DcjmXfUi.js";import"./utils-vendor-Dyq5Ev4R.js";import"./animation-vendor-U7UFP-tZ.js";const u=()=>{const[e,a]=p.useState([]),[t,s]=p.useState([]),[r,n]=p.useState([]),[i,u]=p.useState(!0),[y,g]=p.useState(!1),[h,b]=p.useState(""),[f,j]=p.useState(!1),[v,N]=p.useState(null),[k,w]=p.useState(""),[_,C]=p.useState([]),[S,I]=p.useState("roamify-packages"),[D,P]=p.useState(1),[O,F]=p.useState(1),[A,$]=p.useState(0),[E]=p.useState(50),[M,T]=p.useState(""),L=Array.from(new Set(r.map(e=>e.country).filter(Boolean))).sort(),U=M?r.filter(e=>e.country===M):r,[B,R]=p.useState(null),[G,J]=p.useState(null),[q,H]=p.useState({}),[K,Y]=p.useState(""),[V,z]=p.useState(100),[Q,W]=p.useState({totalPackages:0,duplicateIds:{},duplicateCombinations:{},hasDuplicates:!1});p.useEffect(()=>{X()},[]),p.useEffect(()=>{Z()},[k,D]);const X=()=>c(null,null,function*(){try{const e=m.map(e=>e.name.en);C(e)}catch(e){const a=m.map(e=>e.name.en);C(a)}}),Z=()=>c(null,null,function*(){u(!0);try{yield Promise.all([ee(),ae(),te()])}catch(e){b("Failed to fetch data")}finally{u(!1)}}),ee=()=>c(null,null,function*(){try{const e=yield fetch("/api/admin/my-packages");if(e.ok){const t=yield e.json();a(t)}else b("Failed to fetch my packages")}catch(e){b("Failed to fetch my packages")}}),ae=()=>c(null,null,function*(){var e;try{const a=yield fetch("/api/admin/packages");if(a.ok){const t=yield a.json();s(t.data||[]),$((null==(e=t.data)?void 0:e.length)||0),F(1)}else b("Failed to fetch main packages")}catch(a){b("Failed to fetch main packages")}}),te=()=>c(null,null,function*(){try{console.log("Fetching Roamify packages..."),g(!0);const e=yield fetch("/api/admin/all-roamify-packages");if(e.ok){const a=yield e.json();console.log("Roamify packages received:",a.length),console.log("First package sample:",a[0]);const t=se(a);W(t),console.log("=== DUPLICATE ANALYSIS ==="),console.log(`Total packages: ${t.totalPackages}`),console.log(`Has duplicates: ${t.hasDuplicates}`),t.hasDuplicates&&(console.log("=== DUPLICATE IDS ==="),Object.entries(t.duplicateIds).forEach(([e,a])=>{console.log(`ID "${e}" appears ${a.length} times:`,a.map(e=>({name:e.packageName||e.name||e.package,country:e.country,data:e.data_amount||e.dataAmount||e.data,days:e.validity_days||e.days||e.day,price:e.base_price||e.price})))}),console.log("=== DUPLICATE COMBINATIONS ==="),Object.entries(t.duplicateCombinations).forEach(([e,a])=>{console.log(`Combination "${e}" appears ${a.length} times:`,a.map(e=>({id:e.packageId||e.id,name:e.packageName||e.name||e.package,country:e.country,data:e.data_amount||e.dataAmount||e.data,days:e.validity_days||e.days||e.day,price:e.base_price||e.price})))})),n(a)}else console.error("Failed to fetch Roamify packages:",e.status,e.statusText),b("Failed to fetch Roamify packages")}catch(e){console.error("Error fetching Roamify packages:",e),b("Failed to fetch Roamify packages")}finally{g(!1)}}),se=e=>{const a=e.length,t={},s={},r={};e.forEach(e=>{const a=e.packageId||e.id||"unknown";r[a]||(r[a]=[]),r[a].push(e)}),Object.entries(r).forEach(([e,a])=>{a.length>1&&(t[e]=a)});const n={};e.forEach(e=>{const a=`${e.country||"unknown"}|${e.data_amount||e.dataAmount||e.data||"unknown"}|${e.validity_days||e.days||e.day||"unknown"}|${e.base_price||e.price||"unknown"}`;n[a]||(n[a]=[]),n[a].push(e)}),Object.entries(n).forEach(([e,a])=>{a.length>1&&(s[e]=a)});const i=Object.keys(t).length>0||Object.keys(s).length>0;return{totalPackages:a,duplicateIds:t,duplicateCombinations:s,hasDuplicates:i}},re=e=>c(null,null,function*(){var a;N(e.packageId||e.id||"");try{if("Europe & United States"!==e.country)return x.error("Only Europe & United States packages can be saved as Most Popular. This package will be saved to its country-specific page instead."),void(yield(e=>c(null,null,function*(){var a,t;N(e.packageId||e.id||"");try{const s=e.packageName||e.name||e.package||"Unknown Package",r=e.country||e.country_name||"",n=e.country_code||"";let i=e.data_amount||e.dataAmount||e.data||"",l=0;if("number"==typeof i)l=i;else if("string"==typeof i){const e=i.match(/(\d+(?:\.\d+)?)(GB|MB|KB)?/i);if(e){let t=parseFloat(e[1]);const s=(null==(a=e[2])?void 0:a.toUpperCase())||"GB";"MB"===s&&(t/=1024),"KB"===s&&(t/=1048576),l=t}}const d=e.validity_days||e.days||e.day||0,c=e.base_price||e.price||0,o=null!=(t=q[e.packageId||e.id||""])?t:c.toString(),p=""===o?c:parseFloat(o),m=e.packageId||e.id||"",u=e.region||"";if(!(s&&r&&n&&l&&d&&c))return x.error("Cannot save: Missing required fields."),b("Cannot save: Missing required fields."),void N(null);const y={name:s,country_name:r,country_code:n,data_amount:l,validity_days:d,base_price:c,sale_price:p,profit:p-c,reseller_id:m,region:u,show_on_frontend:!0,location_slug:"Europe & United States"===r?"":n.toLowerCase(),homepage_order:0},g=yield fetch("/api/admin/save-package",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(g.ok)yield ee(),b(""),x.success("Europe & United States"===r?'Package saved successfully! Use "Save as Most Popular" to show in Most Popular section.':`Package saved successfully! It will appear on the ${r} page.`);else{const e=`Failed to save package: ${(yield g.json()).error||"Unknown error"}`;x.error(e),b(e)}}catch(s){const e="Failed to save package";x.error(e),b(e)}finally{N(null)}}))(e));const t=e.base_price||e.price||0,s=null!=(a=q[e.packageId||e.id||""])?a:t.toString(),r=""===s?t:parseFloat(s),n={id:e.packageId||e.id||"",country:e.country||e.country_name||"",country_code:e.country_code||"",data:e.data_amount||e.dataAmount||e.data||"",days:e.validity_days||e.days||e.day||0,base_price:t,sale_price:r,profit:r-t,show_on_frontend:!0,location_slug:"most-popular",homepage_order:1},i=yield fetch("/api/save-package",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(i.ok)yield ee(),b(""),x.success("Package saved to Most Popular section successfully!");else{const e=`Failed to save package: ${(yield i.json()).error||"Unknown error"}`;x.error(e),b(e)}}catch(t){const e="Failed to save package";x.error(e),b(e)}finally{N(null)}});return o.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsx("div",{className:"flex justify-between items-center mb-8",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Panel"}),o.jsx("p",{className:"text-gray-600",children:"eSIM Package Management"})]})}),h&&o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:h}),o.jsx("div",{className:"border-b border-gray-200 mb-6",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>I("my-packages-only"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("my-packages-only"===S?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["My Packages Only (",e.length,")"]}),o.jsxs("button",{onClick:()=>I("roamify-packages"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("roamify-packages"===S?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Roamify Packages (",r.length,")"]})]})}),"my-packages-only"===S&&o.jsxs("div",{className:"bg-white shadow rounded-lg",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["My eSIM Packages Only (",e.length,")"]}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage your eSIM packages with edit and delete functionality"}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{htmlFor:"my-packages-country-search",className:"block text-sm font-medium text-gray-700",children:"Search by Country:"}),o.jsxs("div",{className:"mt-1 flex gap-2",children:[o.jsx("input",{type:"text",id:"my-packages-country-search",placeholder:"Search country...",value:K,onChange:e=>Y(e.target.value),className:"flex-1 pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"}),K&&o.jsx("button",{onClick:()=>Y(""),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50",children:"Clear"})]}),K&&o.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Showing ",e.filter(e=>e.country_name.toLowerCase().includes(K.toLowerCase())).length," of ",e.length," packages"]})]})]}),i?o.jsx("div",{className:"px-6 py-8 text-center text-xl",children:"Loading packages..."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Package"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country Code"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data (GB)"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Base Price"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sale Price"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(e=>!K||e.country_name.toLowerCase().includes(K.toLowerCase())).map(e=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"text",value:B.name,onChange:e=>R(d(l({},B),{name:e.target.value})),className:"w-48 px-2 py-1 border border-gray-300 rounded text-sm"}):o.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),o.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"text",value:B.country_name,onChange:e=>R(d(l({},B),{country_name:e.target.value})),className:"w-32 px-2 py-1 border border-gray-300 rounded text-sm"}):o.jsx("span",{className:"text-sm text-gray-900",children:e.country_name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"text",value:B.country_code||"",onChange:e=>R(d(l({},B),{country_code:e.target.value})),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"e.g., DE"}):o.jsx("span",{className:"text-sm text-gray-900",children:e.country_code||"N/A"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"number",step:"0.1",value:(B.data_amount/1024).toFixed(1),onChange:e=>R(d(l({},B),{data_amount:1024*Number(e.target.value)})),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"GB"}):o.jsxs("span",{className:"text-sm text-gray-900",children:[(e.data_amount/1024).toFixed(1)," GB"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"number",value:B.validity_days,onChange:e=>R(d(l({},B),{validity_days:Number(e.target.value)})),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm"}):o.jsx("span",{className:"text-sm text-gray-900",children:e.validity_days})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"number",step:"0.01",value:B.base_price,onChange:e=>R(d(l({},B),{base_price:Number(e.target.value)})),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm"}):o.jsxs("span",{className:"text-sm text-gray-900",children:["$",e.base_price]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"number",step:"0.01",value:B.sale_price,onChange:e=>R(d(l({},B),{sale_price:Number(e.target.value)})),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm"}):o.jsx("input",{type:"number",step:"0.01",value:e.sale_price,onChange:t=>((e,t)=>{const s=parseFloat(t)||0;a(a=>a.map(a=>a.id===e?d(l({},a),{sale_price:s,profit:s-a.base_price}):a))})(e.id,t.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==B?void 0:B.id)===e.id?o.jsx("input",{type:"number",step:"0.01",value:B.profit,readOnly:!0,className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm bg-gray-100"}):o.jsxs("span",{className:"text-sm "+(e.profit>0?"text-green-600":"text-red-600"),children:["$",e.profit.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(null==B?void 0:B.id)===e.id?o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>(e=>c(null,null,function*(){j(!0);try{const a=d(l({},e),{data_amount:e.data_amount/1024}),t=yield fetch(`/api/admin/update-package/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok)yield ee(),R(null),b("");else{const e=yield t.json();b(`Failed to save package: ${e.error||"Unknown error"}`)}}catch(a){b("Failed to save package")}finally{j(!1)}}))(B),disabled:f,className:"text-indigo-600 hover:text-indigo-900 disabled:opacity-50",children:f?"Saving...":"Save"}),o.jsx("button",{onClick:()=>R(null),className:"text-gray-600 hover:text-gray-900",children:"Cancel"})]}):o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>(e=>c(null,null,function*(){R(e)}))(e),className:"text-indigo-600 hover:text-indigo-900",children:"Edit"}),o.jsx("button",{onClick:()=>{return a=e.id,c(null,null,function*(){if(window.confirm("Are you sure you want to delete this package?")){J(a);try{(yield fetch(`/api/admin/delete-package/${a}`,{method:"DELETE"})).ok?(yield ee(),b("")):b("Failed to delete package")}catch(e){b("Failed to delete package")}finally{J(null)}}});var a},disabled:G===e.id,className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:G===e.id?"Deleting...":"Delete"})]})})]},e.id))})]})})]}),"roamify-packages"===S&&o.jsxs("div",{className:"bg-white shadow rounded-lg",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Roamify Packages (",r.length,")"]}),o.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Available packages from Roamify API - Edit sale price and save to your inventory"}),!y&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Package Analysis"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{className:"bg-white p-3 rounded border",children:[o.jsx("div",{className:"font-medium text-gray-700",children:"Total Packages"}),o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Q.totalPackages})]}),o.jsxs("div",{className:"bg-white p-3 rounded border",children:[o.jsx("div",{className:"font-medium text-gray-700",children:"Duplicate IDs"}),o.jsx("div",{className:"text-2xl font-bold "+(Q.hasDuplicates?"text-red-600":"text-green-600"),children:Object.keys(Q.duplicateIds).length})]}),o.jsxs("div",{className:"bg-white p-3 rounded border",children:[o.jsx("div",{className:"font-medium text-gray-700",children:"Duplicate Combinations"}),o.jsx("div",{className:"text-2xl font-bold "+(Q.hasDuplicates?"text-red-600":"text-green-600"),children:Object.keys(Q.duplicateCombinations).length})]})]}),Q.hasDuplicates&&o.jsx("div",{className:"mt-4",children:o.jsxs("details",{className:"bg-white p-3 rounded border",children:[o.jsx("summary",{className:"cursor-pointer font-medium text-red-700 hover:text-red-800",children:"ðŸ” View Duplicate Details (Click to expand)"}),o.jsxs("div",{className:"mt-3 space-y-4",children:[Object.keys(Q.duplicateIds).length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Duplicate IDs:"}),o.jsx("div",{className:"space-y-2",children:Object.entries(Q.duplicateIds).map(([e,a])=>o.jsxs("div",{className:"bg-red-50 p-2 rounded border-l-4 border-red-400",children:[o.jsxs("div",{className:"font-medium text-red-800",children:["ID: ",e," (appears ",a.length," times)"]}),a.map((e,a)=>o.jsxs("div",{className:"text-sm text-red-700 ml-4",children:[a+1,". ",e.packageName||e.name||e.package," - ",e.country," - ",e.data_amount||e.dataAmount||e.data," - ",e.validity_days||e.days||e.day," days - $",e.base_price||e.price]},a))]},e))})]}),Object.keys(Q.duplicateCombinations).length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Duplicate Combinations (Country + Data + Days + Price):"}),o.jsx("div",{className:"space-y-2",children:Object.entries(Q.duplicateCombinations).map(([e,a])=>o.jsxs("div",{className:"bg-orange-50 p-2 rounded border-l-4 border-orange-400",children:[o.jsxs("div",{className:"font-medium text-orange-800",children:["Combination: ",e," (appears ",a.length," times)"]}),a.map((e,a)=>o.jsxs("div",{className:"text-sm text-orange-700 ml-4",children:[a+1,". ID: ",e.packageId||e.id," - ",e.packageName||e.name||e.package]},a))]},e))})]})]})]})})]}),!y&&Q.hasDuplicates&&o.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[o.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"ðŸ“‹ Duplicate Indicators Legend:"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-xs",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-3 h-3 bg-red-50 border-l-4 border-red-400 mr-2"}),o.jsx("span",{className:"text-yellow-700",children:"Red background = Duplicate package"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 mr-2",children:"Duplicate ID"}),o.jsx("span",{className:"text-yellow-700",children:"Same package ID appears multiple times"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 mr-2",children:"Duplicate Combo"}),o.jsx("span",{className:"text-yellow-700",children:"Same country + data + days + price combination"})]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{htmlFor:"country-filter",className:"block text-sm font-medium text-gray-700",children:"Filter by Country:"}),o.jsx("input",{type:"text",placeholder:"Search country...",value:K,onChange:e=>Y(e.target.value),className:"mt-1 mb-2 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"}),o.jsxs("select",{id:"country-filter",value:M,onChange:e=>T(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[o.jsxs("option",{value:"",children:["All Countries (",r.length,")"]}),L.filter(e=>!!e&&e.toLowerCase().includes(K.toLowerCase())).map(e=>o.jsx("option",{value:e,children:e},e))]})]})]}),y?o.jsxs("div",{className:"px-6 py-8 text-center text-xl",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-4"}),"Loading Roamify packages... This may take a moment for 22,000+ packages."]}):o.jsxs("div",{className:"overflow-x-auto",style:{maxHeight:600,overflowY:"auto"},children:[o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Package"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country Code"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data (GB)"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Base Price"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sale Price"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profit"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:U.slice(0,V).map(e=>{var a;const t=e.base_price||e.price||0,s=parseFloat(null!=(a=q[e.packageId||e.id||""])?a:t.toString())-t,r=e.packageId||e.id||"unknown",n=`${e.country||"unknown"}|${e.data_amount||e.dataAmount||e.data||"unknown"}|${e.validity_days||e.days||e.day||"unknown"}|${e.base_price||e.price||"unknown"}`,i=Q.duplicateIds[r]&&Q.duplicateIds[r].length>1,c=Q.duplicateCombinations[n]&&Q.duplicateCombinations[n].length>1,p=i||c;return o.jsxs("tr",{className:"hover:bg-gray-50 "+(p?"bg-red-50 border-l-4 border-red-400":""),children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[e.packageName||e.name||e.package||"Unknown Package",p&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:i&&c?"Duplicate ID & Combo":i?"Duplicate ID":"Duplicate Combo"})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.packageId||e.id]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"text-sm text-gray-900",children:e.country})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"text-sm text-gray-900",children:e.country_code||"N/A"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"text-sm text-gray-900",children:e.data_amount||e.dataAmount||e.data||"N/A"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"text-sm text-gray-900",children:e.validity_days||e.days||e.day||"N/A"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("span",{className:"text-sm text-gray-900",children:["$",t.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("input",{type:"text",inputMode:"decimal",value:void 0!==q[e.packageId||e.id||""]?q[e.packageId||e.id||""]:t.toString(),onChange:a=>{const t=a.target.value;/^\d*\.?\d*$/.test(t)&&H(d(l({},q),{[e.packageId||e.id||""]:t}))},className:"w-32 px-4 py-2 border-2 border-indigo-500 rounded-lg text-lg font-semibold text-center focus:ring-2 focus:ring-indigo-400 focus:border-indigo-600 transition-all",placeholder:"Sale Price"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("span",{className:"text-sm "+(s>=0?"text-green-600":"text-red-600"),children:["$",s.toFixed(2)]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsx("button",{onClick:()=>re(e),disabled:v===(e.packageId||e.id),className:"text-indigo-600 hover:text-indigo-900 disabled:opacity-50",children:v===(e.packageId||e.id)?"Saving...":"Save"})})]},e.packageId||e.id)})})]}),U.length>V&&o.jsx("div",{className:"text-center my-4",children:o.jsx("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",onClick:()=>z(e=>e+100),children:"Show More"})})]})]})]})})};export{u as default};
