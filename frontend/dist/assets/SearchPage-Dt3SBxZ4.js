import{j as e}from"./ui-B6UisXh3.js";import{f as s,r as a}from"./router-DECodpxX.js";import{c as t,u as r,B as l,f as c}from"./index-B9lVnXED.js";import{I as i,B as n}from"./input-mgqqA7cj.js";import{S as o,C as d}from"./search-Vg2J7IzA.js";import{G as m,W as x}from"./wifi-oHE6F6zN.js";import{o as h,s as u}from"./types-G7CTAjld.js";import"./vendor-DEQ385Nk.js";import"./three-CdCYxwFx.js";import"./supabase-Bj79fh9f.js";import"./utils-BpqZfnrR.js";
/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=t("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),g=h({userEmail:u().email("Please enter a valid email"),userName:u().optional()}),j=()=>{const[t,h]=s(),[u,j]=a.useState(t.get("country")||""),[f,y]=a.useState([]),[N,b]=a.useState(!1),[v,w]=a.useState(""),[_,k]=a.useState(null),[S,C]=a.useState(""),[E,I]=a.useState(""),{t:P,language:$}=r(),[B,F]=a.useState({});a.useEffect(()=>{u&&G(u)},[u,$]);const G=async e=>{b(!0),w("");try{const s=await fetch(`/api/search-packages?country=${encodeURIComponent(e)}&lang=${$}`);if(s.ok){const e=await s.json();y(e)}else w(P("failed_to_search_packages"))}catch(s){w(P("failed_to_search_packages"))}finally{b(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:P("search_esim_packages")}),e.jsx("p",{className:"text-xl text-gray-600",children:P("find_the_perfect_package")})]}),e.jsx("div",{className:"max-w-2xl mx-auto mb-12",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),u.trim()&&(h({country:u.trim()}),G(u.trim()))},className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(i,{type:"text",placeholder:P("enter_country_name_placeholder"),value:u,onChange:e=>j(e.target.value),className:"w-full"})}),e.jsxs(l,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),P("search")]})]})}),N&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-xl",children:P("searching_packages")})}),v&&e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"text-red-600",children:[P("error"),": ",v]})}),!N&&!v&&u&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:[P("packages_for")," ",u]}),e.jsxs("p",{className:"text-gray-600",children:[f.length," ",P("package"),1!==f.length?"s":""," ",P("found")]})]}),0===f.length?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"text-gray-500 text-lg",children:[P("no_packages_found_for"),' "',u,'". ',P("try_different_country")]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(s=>e.jsx("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.name[$]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(m,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.country_name[$]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:c(s.data_amount)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.days," ",P("days")]})]})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¬","number"!=typeof s.sale_price||isNaN(s.sale_price)?"0.00":s.sale_price.toFixed(2)]})}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-6 justify-center",children:[e.jsx(n,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:"4G/5G"}),e.jsx(n,{variant:"secondary",className:"bg-green-100 text-green-700 text-xs",children:"Instant"}),e.jsx(n,{variant:"secondary",className:"bg-purple-100 text-purple-700 text-xs",children:s.region})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("input",{type:"email",placeholder:"Your email address",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("input",{type:"text",placeholder:"Your name (optional)",value:E,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),B[s.id]&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:B[s.id]}),e.jsxs(l,{onClick:()=>(async e=>{const s=g.safeParse({userEmail:S,userName:E});if(s.success){F(s=>({...s,[e.id]:""})),k(e.id);try{const s=await fetch("/api/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:e.id,userEmail:S.trim(),userName:E.trim()||S.trim()})}),a=await s.json();s.ok?(alert(`Order created successfully! QR code will be sent to ${S}`),C(""),I("")):alert(`Failed to create order: ${a.error||"Unknown error"}`)}catch(a){alert("Failed to create order. Please try again.")}finally{k(null)}}else F(a=>({...a,[e.id]:s.error.errors[0].message}))})(s),disabled:_===s.id,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white py-2 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(p,{className:"w-4 h-4"}),_===s.id?"Processing...":"Buy Now"]})]})},s.id))})]}),!N&&!v&&!u&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500 text-lg",children:"Enter a country name above to search for eSIM packages."})})]})})};export{j as default};
