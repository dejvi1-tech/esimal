import{j as e}from"./ui-B6UisXh3.js";import{r as s}from"./router-DECodpxX.js";import{u as t,H as a}from"./index-B9lVnXED.js";import{o as r,s as l}from"./types-G7CTAjld.js";import"./vendor-DEQ385Nk.js";import"./three-CdCYxwFx.js";import"./supabase-Bj79fh9f.js";import"./utils-BpqZfnrR.js";const i=()=>{const{t:i}=t(),[n,d]=s.useState(""),[o,m]=s.useState(!1),[c,x]=s.useState(null),[u,p]=s.useState(null),h=r({esimNumber:l().min(8,"Please enter a valid eSIM number")}),b=e=>null==e?"0":e<.01&&e>0?e.toFixed(3):e<1?e.toFixed(2):e.toFixed(1),f=()=>u&&u.dataLimit&&0!==u.dataLimit?Math.min(u.dataUsed/u.dataLimit*100,100):0,g=u&&(0===u.dataRemaining&&u.dataUsed>0||"expired"===u.status||"inactive"===u.status);return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[e.jsx(a,{children:e.jsxs("title",{children:[i("check_balance")," - e-SimFly"]})}),e.jsxs("div",{className:"max-w-xl w-full space-y-8 text-center bg-slate-100/30 dark:bg-slate-900/50 backdrop-blur-sm border border-white/20 p-8 rounded-2xl shadow-lg",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-4xl font-extrabold text-gray-800 dark:text-gray-200",children:i("your_esim_data")})}),e.jsx("form",{className:"mt-8 space-y-6",onSubmit:async e=>{e.preventDefault();const s=h.safeParse({esimNumber:n});if(s.success){m(!0),x(null),p(null);try{const e=await fetch(`/api/esims/usage/${n.trim()}`),s=await e.json();if(!e.ok)throw new Error(s.message||"Failed to fetch usage details");p(s.data)}catch(t){x(t.message||"Failed to check balance")}finally{m(!1)}}else x(s.error.errors[0].message)},children:e.jsx("div",{className:"rounded-md -space-y-px",children:e.jsxs("div",{className:"text-left",children:[e.jsx("label",{htmlFor:"esim-number",className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:i("your_esim_number")}),e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("input",{id:"esim-number",name:"esim",type:"text",className:"appearance-none relative block w-full px-3 py-4 bg-white/50 dark:bg-slate-800/50 border border-white/30 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-gray-100 rounded-l-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:i("enter_your_esim_number"),value:n,onChange:e=>d(e.target.value),disabled:o}),e.jsx("button",{type:"submit",className:"inline-flex items-center px-8 py-2 border border-transparent text-sm font-medium rounded-r-md text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",disabled:o,children:i(o?"loading":"check_balance")})]})]})})}),c&&e.jsx("div",{className:"mt-6 text-red-600 dark:text-red-400 font-semibold",children:c}),u&&e.jsxs("div",{className:"mt-8 p-6 rounded-xl bg-gradient-to-br from-purple-900 via-blue-900 to-slate-900 border border-purple-700 shadow-2xl text-left text-white",children:[e.jsxs("div",{className:"mb-4 text-lg font-bold text-purple-200",children:["eSIM: ",e.jsx("span",{className:"font-mono",children:u.iccid})]}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-200",children:"Status:"}),g?e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold bg-red-200 text-red-900",children:"Expired ❌"}):e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold bg-green-200 text-green-900",children:"Active ✅"})]}),e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsxs("div",{className:"text-sm text-gray-200",children:["Usage: ",e.jsxs("span",{className:"font-semibold text-white",children:[b(u.dataUsed)," GB"]})," / ",e.jsxs("span",{className:"font-semibold text-white",children:[b(u.dataLimit)," GB"]})]}),e.jsxs("div",{className:"text-sm text-gray-200",children:["Remaining: ",e.jsxs("span",{className:"font-semibold text-white",children:[b(u.dataRemaining)," GB"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:`bg-gradient-to-r ${(()=>{const e=f();return e<30?"from-green-400 to-green-600":e<70?"from-yellow-400 to-orange-500":"from-red-400 to-red-600"})()} h-4 rounded-full transition-all duration-1000 ease-out`,style:{width:`${f()}%`,animation:"slideIn 1s ease-out"}})})})]})]}),e.jsx("style",{jsx:!0,children:`\n        @keyframes slideIn {\n          from {\n            width: 0%;\n          }\n          to {\n            width: ${u?f():0}%;\n          }\n        }\n      `})]})};export{i as default};
