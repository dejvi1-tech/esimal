import{j as e}from"./ui-vendor-Cb7BQMVa.js";import{i as t,f as a,a as s}from"./react-vendor-gzvTUj6_.js";import{H as l,i as r}from"./index-DcjmXfUi.js";import{e as n}from"./countries-CNVzw6Kl.js";import"./utils-vendor-Dyq5Ev4R.js";import"./animation-vendor-U7UFP-tZ.js";const i=({pkg:t,selected:a,onSelect:s})=>e.jsxs("div",{className:"flex flex-col justify-between p-4 bg-white rounded-xl shadow border transition-all cursor-pointer h-full "+(a?"border-purple-600 ring-2 ring-purple-200":"border-gray-200 hover:border-purple-300"),onClick:s,style:{minHeight:"110px"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:r(t.data_amount)}),e.jsx("span",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(a?"border-purple-600 bg-purple-600":"border-gray-300 bg-white"),children:a&&e.jsx("span",{className:"w-2 h-2 bg-white rounded-full block"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[t.validity_days," Ditë"]}),e.jsxs("span",{className:"font-bold text-base "+(a?"text-purple-700":"text-gray-800"),children:["€",t.sale_price.toFixed(2)]})]})]}),o=()=>{const{bundleId:r}=t(),o=a(),[d,c]=s.useState([]),[m,u]=s.useState(!0),[x,p]=s.useState(""),[h,g]=s.useState(null),[f,j]=s.useState(null);if(s.useEffect(()=>{if(!r)return;u(!0),fetch(`/api/search-packages?country=${encodeURIComponent(r)}`).then(e=>{if(!e.ok)throw new Error("Failed to fetch");return e.json()}).then(e=>{console.log("Raw packages from API:",e);const t=e.filter((e,t,a)=>t===a.findIndex(t=>t.data_amount===e.data_amount&&t.validity_days===e.validity_days&&t.sale_price===e.sale_price&&t.country_name===e.country_name));console.log("Deduplicated packages:",t),c(t),t.length>0&&g(t[0].id),u(!1)}).catch(()=>{p("Failed to fetch packages for this bundle."),u(!1)});const e=n.find(e=>e.code.toLowerCase()===r.toLowerCase()||e.name.en.toLowerCase()===r.toLowerCase());j(e?{name:e.name.en,flag:e.flag}:{name:r.charAt(0).toUpperCase()+r.slice(1),flag:""})},[r]),m)return e.jsx("div",{className:"text-center py-20",children:"Loading packages..."});if(x)return e.jsx("div",{className:"text-center py-20 text-red-600",children:x});const b=f?`${f.name} Packages`:"Bundle Packages";return e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx("title",{children:b})}),e.jsxs("div",{className:"container mx-auto px-4 py-12 pt-24",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[(null==f?void 0:f.flag)&&e.jsx("img",{src:f.flag,alt:f.name,className:"w-20 h-14 rounded-lg shadow-md mb-4 object-cover"}),e.jsx("h1",{className:"text-4xl font-bold text-slate-800 dark:text-white",children:null==f?void 0:f.name})]}),0===d.length?e.jsx("p",{className:"text-center text-gray-500 text-lg",children:"No eSIM packages available yet for this destination."}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-8",children:d.map(t=>e.jsx(i,{pkg:t,selected:h===t.id,onSelect:()=>g(t.id)},t.id))}),e.jsx("button",{className:"w-full bg-purple-600 hover:bg-purple-700 text-white text-lg font-bold py-3 rounded-full shadow-lg transition-all duration-200 disabled:opacity-50",onClick:()=>{h&&o(`/checkout?country=${r}&package=${h}`)},disabled:!h,children:"Buy Now"})]})]})]})};export{o as default};
